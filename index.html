<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Zoom Infini Test</title>
    <script src="https://openseadragon.github.io/openseadragon/openseadragon.min.js"></script>
    <style>
        html, body { margin:0; padding:0; height:100%; }
        #viewer { width: 100%; height: 100vh; background-color: black; }
    </style>
</head>
<body>
<div id="viewer"></div>

<script>
    var viewer = OpenSeadragon({
        id: "viewer",
        prefixUrl: "https://openseadragon.github.io/openseadragon/images/",
        tileSources: "sortie.dzi",
        showNavigator: false
    });

    let firstPoint = null;

    viewer.addHandler('canvas-click', function(event){
        if(!event.position) return;

        let viewportPoint = viewer.viewport.pointFromPixel(event.position);
        let img = viewer.world.getItemAt(0);
        let imagePoint = viewer.viewport.viewportToImageCoordinates(viewportPoint);
        let imgSize = img.getContentSize();

        let normX = imagePoint.x / imgSize.x;
        let normY = imagePoint.y / imgSize.y;

        if(!firstPoint){
            firstPoint = { x: normX, y: normY };
            console.log("Coin haut gauche enregistré :", firstPoint);
        } else {
            let secondPoint = { x: normX, y: normY };
            let x = Math.min(firstPoint.x, secondPoint.x);
            let y = Math.min(firstPoint.y, secondPoint.y);
            let width = Math.abs(secondPoint.x - firstPoint.x);
            let height = Math.abs(secondPoint.y - firstPoint.y);

            console.log("==== DETAIL COORDS PRÊT À COLLER ====");
            console.log(`x: ${x}`);
            console.log(`y: ${y}`);
            console.log(`width: ${width}`);
            console.log(`height: ${height}`);

            // Réinitialise pour une nouvelle sélection
            firstPoint = null;
        }
    });
</script>
</body>
</html>



